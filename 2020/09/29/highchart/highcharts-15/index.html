<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>資視就是力量 - Highcharts / 日期座標軸&amp;語言設定 | Max&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="本章節範例：https:&#x2F;&#x2F;codepen.io&#x2F;max-lee&#x2F;pen&#x2F;GRZwKjW  今天要又要來填坑了，在座標軸設定時有說會特別介紹「日期座標軸」，因為它的設定不僅僅與「座標軸設定」有關，還必須連動「數據列設定」，並且搭配昨天介紹的「格式化屬性」，算是比較複雜的應用。   另外今天還會提到「語言設定」，它可以讓我們定義一些因 地區習慣 不同而變化的預設字符，包含昨天的千份位符號以及今天會">
<meta property="og:type" content="article">
<meta property="og:title" content="資視就是力量 - Highcharts &#x2F; 日期座標軸&amp;語言設定">
<meta property="og:url" content="https://maxleebk.com/2020/09/29/highchart/highcharts-15/index.html">
<meta property="og:site_name" content="Max&#39;s Blog">
<meta property="og:description" content="本章節範例：https:&#x2F;&#x2F;codepen.io&#x2F;max-lee&#x2F;pen&#x2F;GRZwKjW  今天要又要來填坑了，在座標軸設定時有說會特別介紹「日期座標軸」，因為它的設定不僅僅與「座標軸設定」有關，還必須連動「數據列設定」，並且搭配昨天介紹的「格式化屬性」，算是比較複雜的應用。   另外今天還會提到「語言設定」，它可以讓我們定義一些因 地區習慣 不同而變化的預設字符，包含昨天的千份位符號以及今天會">
<meta property="og:locale">
<meta property="og:image" content="https://maxleebk.com/2020/09/29/highchart/highcharts-15/axisNoDate.png">
<meta property="og:image" content="https://maxleebk.com/2020/09/29/highchart/highcharts-15/tickInterval.png">
<meta property="og:image" content="https://maxleebk.com/2020/09/29/highchart/highcharts-15/pointInterval.png">
<meta property="og:image" content="https://maxleebk.com/2020/09/29/highchart/highcharts-15/pointStart.png">
<meta property="og:image" content="https://maxleebk.com/2020/09/29/highchart/highcharts-15/utc.png">
<meta property="og:image" content="https://maxleebk.com/2020/09/29/highchart/highcharts-15/specifyPoint.png">
<meta property="og:image" content="https://maxleebk.com/2020/09/29/highchart/highcharts-15/lang.png">
<meta property="og:image" content="https://maxleebk.com/2020/09/29/highchart/highcharts-15/dateSymbol.png">
<meta property="og:image" content="https://maxleebk.com/2020/09/29/highchart/highcharts-15/format.png">
<meta property="article:published_time" content="2020-09-29T04:30:00.000Z">
<meta property="article:modified_time" content="2023-10-23T04:01:13.520Z">
<meta property="article:author" content="Max Lee">
<meta property="article:tag" content="JavaScript">
<meta property="article:tag" content="Highcharts">
<meta property="article:tag" content="12th鐵人賽">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://maxleebk.com/2020/09/29/highchart/highcharts-15/axisNoDate.png">
  
    <link rel="alternate" href="/atom.xml" title="Max&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/css/images/favicon.ico">
  
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-landing">
      <a href="/" id="header-avatar"></a>
      <div id="header-title">
        <h1 id="logo-wrap">
          <a href="/" id="logo">Max&#39;s Blog</a>
        </h1>
        
      </div>
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Article</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
      </nav>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-highchart/highcharts-15" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        <div class="article-header-wrap">
          
  
    <h1 class="article-title" itemprop="name">
      資視就是力量 - Highcharts / 日期座標軸&amp;語言設定
    </h1>
  

          <div>
            <p class="article-date">
  Posted by Max on
  <time datetime="2020-09-29T04:30:00.000Z" itemprop="datePublished">2020-09-29</time>
</p>
          </div>
        </div>
      </header>
    
    
        <div class="article-excerpt" itemprop="articleBody">
          <div class="post-cate">
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/12th%E9%90%B5%E4%BA%BA%E8%B3%BD/" rel="tag">12th鐵人賽</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Highcharts/" rel="tag">Highcharts</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li></ul>

            
          </div>
          
        </div>
      
        <div class="article-entry" itemprop="articleBody">
          <blockquote>
<p>本章節範例：<strong><a target="_blank" rel="noopener" href="https://codepen.io/max-lee/pen/GRZwKjW">https://codepen.io/max-lee/pen/GRZwKjW</a></strong></p>
</blockquote>
<p>今天要又要來填坑了，在座標軸設定時有說會特別介紹「日期座標軸」，因為它的設定不僅僅與「座標軸設定」有關，還必須連動「數據列設定」，並且搭配昨天介紹的「格式化屬性」，算是比較複雜的應用。</p>
<br/>

<p>另外今天還會提到「語言設定」，它可以讓我們定義一些因 <strong>地區習慣</strong> 不同而變化的預設字符，包含昨天的千份位符號以及今天會用到的月份、星期名稱…等等。</p>
<hr>
<h2 id="日期座標軸"><a href="#日期座標軸" class="headerlink" title="日期座標軸"></a>日期座標軸</h2><p>當圖表的資料是包含時間維度的，那就有使用「日期座標軸的」需求，用來標示個別數據點的測量／紀錄時間。</p>
<p>而在 <strong><a href="/2020/09/22/highcharts-9/#Axis-type">座標軸設定</a></strong> 介紹過了，只要將 <code>Axis.type</code> 設為 <code>datetime</code> 即可將座標軸設定為「日期座標軸」。</p>
<pre><code class="javascript">var myChart = Highcharts.chart(container, &#123;
  title: &#123; text: &quot;臺北市每日氣溫&quot; &#125;,
  subtitle: &#123; text: &quot;2020年9月第一週&quot; &#125;,
  credits: &#123; enabled: false &#125;,
  xAxis: &#123;
    type: &quot;datetime&quot;
  &#125;,
  yAxis: &#123;
    title: &#123; text: &quot;攝氏溫度&quot; &#125;,
    labels: &#123; format: &quot;&#123;value&#125;°C&quot;&#125;
  &#125;,
  series: [&#123;
    name: &quot;平均溫度&quot;,
    data: [30, 30, 31, 28, 29, 29, 28]
  &#125;]
&#125;);</code></pre>
<p>但如果僅僅只是這樣設定，你會發現座標軸的刻度與 <strong>每日氣溫</strong> 這個圖表主題不太相符，因為「日期座標軸」預設是以 <code>1970/1/1</code> 作為數據點的起始值，並且間距為 <code>1毫秒</code>。那下面我們就以完成這張圖表為目標，一步步學習如何設定「日期座標軸」吧。</p>
<img src="axisNoDate.png" style="max-width: 650px; margin: 24px auto;" />

<h4 id="調整座標刻度間距"><a href="#調整座標刻度間距" class="headerlink" title="# 調整座標刻度間距"></a># 調整座標刻度間距</h4><br/>

<p>首先，我們先將座標刻度的間距改為「一天」，這裡要運用的屬性是 <code>Axis.tickInterval</code>，之前在 <strong><a href="/2020/09/22/highcharts-9/#Axis-tickInterval-Axis-minorTickInterval">座標軸設定</a></strong> 裡一樣有介紹過。</p>
<pre><code class="javascript">xAxis: &#123;
  type: &quot;datetime&quot;,
  tickInterval: 24 * 3600 * 1000 // 一天的毫秒數
&#125;,</code></pre>
<p>設定完之後會發現座標刻度都消失了，只剩下一個 <code>1.Jan</code>，因為雖然刻度間距已經調整為一天了，但數據點之間的時間間隔還是被 Highcharts 認定為是 <code>1毫秒</code>。所以對圖表來說，這七個點都是同一天的數據，自然也就不需要顯示第二天、第三天的刻度了。</p>
<img src="tickInterval.png" style="max-width: 650px; margin: 24px auto;" />

<br/>

<h4 id="調整數據點間距"><a href="#調整數據點間距" class="headerlink" title="# 調整數據點間距"></a># 調整數據點間距</h4><br/>

<p>為了解決上面的問題，要利用之前在 <strong><a href="/2020/09/24/highcharts-11/#series-pointInterval">數據點設定</a></strong> 中提過的 <code>series.pointInterval</code> 來將數據點的間距改為一天。</p>
<pre><code class="javascript">series: [&#123;
  name: &quot;平均溫度&quot;,
  data: [30, 30, 31, 28, 29, 29, 28],
  pointInterval: 24 * 3600 * 1000 // 一天的毫秒數
&#125;]</code></pre>
<p>這樣座標刻度與數據點就對上了，剛好一天一個點，不過目前的起始Ｘ軸座標還是 <code>1970/1/1</code>，所以接下來要將日期改成我們要的九月第一週。</p>
<img src="pointInterval.png" style="max-width: 650px; margin: 24px auto;" />

<br/>

<h4 id="調整數據點起始X值"><a href="#調整數據點起始X值" class="headerlink" title="# 調整數據點起始Ｘ值"></a># 調整數據點起始Ｘ值</h4><br/>

<p>由於我們設定數據點資料的方式是「數值設定法」，所以數據點本身沒有Ｘ軸數值，使得 Highcharts 以 <code>1970/1/1 零毫秒</code> 作為我們第一個數據點的起始Ｘ軸數值，所以我們要用 <code>series.pointStart</code> 來將數據點的起始設定為 <code>8/31</code>，也就是九月第一週的星期一。</p>
<pre><code class="javascript">series: [&#123;
  name: &quot;平均溫度&quot;,
  data: [30, 30, 31, 28, 29, 29, 28],
  pointStart: new Date(&quot;2020/8/31&quot;).getTime(),
  pointInterval: 24 * 3600 * 1000 
&#125;]</code></pre>
<p>在使用日期座標軸的圖表中，數據點Ｘ軸數值是以「時間戳數值」來表示的，所以我們只要傳入 <code>2020/8/31</code> 這一天的時間戳數值即可。</p>
<p>但如此設定後，卻發現數據點發生了偏移，而且看了一下第一個數據點的提示框，發現起始點竟然不是 <code>2020/8/31</code> 而是 <code>2020/8/30 16:00</code>，原來 Highcharts 是以格林威治的時間來計算的，但 <code>new Date()</code> 拿到的是台灣本地時間，所以才會早了八個小時。</p>
<br/>

<blockquote>
<p>台灣的時區是 <code>GMT+8</code>，比格林威治標準時間快八個小時。所以在台灣進入 <code>2020/8/31 00:00</code> 時，格林威治還在 <code>2020/8/30 16:00</code>。</p>
</blockquote>
<img src="pointStart.png" style="max-width: 650px; margin: 24px auto;" />

<br/>

<h4 id="調整時區的時間差"><a href="#調整時區的時間差" class="headerlink" title="# 調整時區的時間差"></a># 調整時區的時間差</h4><br/>

<p>為了讓圖表的數據點時間點和刻度可以對得起來，就要處理因為時區所造成的時間差，這裡有兩種方法提供給大家。</p>
<p>你可以使用「時間設定」裡的 <code>time.timezoneOffset</code> 來告訴 Highcharts 你的時區偏移隔離威治多少，而這個數值可以透過 <code>getTimezoneOffset</code> 這個日期方法來取得。</p>
<pre><code class="javascript">let offset = new Date().getTimezoneOffset(); // -480

var myChart = Highcharts.chart(container, &#123;
  time: &#123; timezoneOffset: offset &#125;
&#125;);</code></pre>
<p>或是比較簡單的做法是以 <code>Date.UTC</code> 來取得時間戳數值，而非 <code>new Date()</code>，因為它可以直接取得國際標準時間的時間戳。</p>
<pre><code class="javascript">series: [&#123;
  name: &quot;平均溫度&quot;,
  data: [30, 30, 31, 28, 29, 29, 28],
  pointStart: Date.UTC(2020, 7, 31),
  pointInterval: 24 * 3600 * 1000 
&#125;]</code></pre>
<p>如此一來，我們就有一個時間完全正確的圖表了。</p>
<img src="utc.png" style="max-width: 650px; margin: 24px auto;" />

<br/>

<h4 id="指定時間的數據點"><a href="#指定時間的數據點" class="headerlink" title="# 指定時間的數據點"></a># 指定時間的數據點</h4><br/>

<p>雖然目前的成果基本滿足需求，但假如 <code>9/3 中午12:00</code> 有一個歷年高溫我們想要加到圖表中，那該怎麼辦？</p>
<p>由於我們已經利用 <code>pointStart</code> 設定了數據點間隔，如果從中穿插一個點，只會讓圖表多增加一天而已，所以在加入這個數據點時，我們要直接為它指定時間戳在Ｘ軸數值。</p>
<pre><code class="javascript">let specifyPoint = &#123;
  x: new Date(&quot;2020/9/3 12:00&quot;).getTime(),
  y: 36,
  color: &quot;red&quot;,
  custom: &quot;中午12:00&quot;
&#125; 

var myChart = Highcharts.chart(container, &#123;
  series: [&#123;
    name: &quot;平均溫度&quot;,
    data: [30, 30, 31, 28, specifyPoint, 29, 29, 28],
    pointStart: new Date(&quot;2020/8/31&quot;).getTime(),
    pointInterval: 24 * 3600 * 1000 
  &#125;]
&#125;);</code></pre>
<p>這樣就可以有指定時間的數據點了，另外，其實你也可以不用 <code>pointStart</code> 和 <code>pointInterval</code>，完全使用指定的Ｘ軸數值來製作日期座標軸圖表。</p>
<img src="specifyPoint.png" style="max-width: 650px; margin: 24px auto;" />

<br/>

<h4 id="語言設定"><a href="#語言設定" class="headerlink" title="# 語言設定"></a># 語言設定</h4><br/>

<p>到這裡，我們的溫度圖表已經完全可以拿來提供給使用者觀看了，可是看著英文的月份和星期實在是有點不親切，為了改變這些 Highcharts 預設的字符，必須使用全域的「語言設定」。</p>
<pre><code class="javascript">Highcharts.setOptions(&#123;
  lang: &#123;
    months: [&#39;一月&#39;, &#39;二月&#39;, .... &#39;十二月&#39;], // 中間省略
    shortMonths: [&#39;1月&#39;, &#39;2月&#39;, .... &#39;12月&#39;], // 中間省略
    weekdays: [&quot;星期一&quot;,&quot;星期二&quot;, .... &quot;星期日&quot;] // 中間省略
  &#125;
&#125;)

var myChart = Highcharts.chart(container, &#123;
  //...省略
&#125;);</code></pre>
<p>程式碼中可以看到一個新的方法 <code>Highcharts.setOptions</code>，它是用來設定全域設定的，影響範圍是頁面中的全部圖表，所以只要設定一次即可。其中「語言設定」必須使用這個方式來定義，這裡我們將月份和星期改成中文的版本。</p>
<p>如此一來，刻度標籤和提示框就有親切的中文顯示囉～</p>
<img src="lang.png" style="max-width: 650px; margin: 24px auto;" />

<blockquote>
<p>另外昨天提到的小數點與千分位符號也是在「語言設定」中調整的。</p>
</blockquote>
<pre><code class="javascript">lang: &#123;
  decimalPoint: &quot;.&quot;, // 小數點預設值
  thousandsSep: &quot;\u0020&quot; // 千分位預設值，\u0020 為空白符號
&#125;</code></pre>
<br/>
<br/>

<h4 id="日期格式化"><a href="#日期格式化" class="headerlink" title="# 日期格式化"></a># 日期格式化</h4><br/>

<p>雖然已經有中文了，不過日期的字串格式似乎不太符合台灣人的習慣，這時候就可以運用昨天才學到的格式化屬性來調整了，而且 Highcharts 一樣有提供日期的特殊符號可以使用。</p>
<img src="dateSymbol.png" style="max-width: 500px; margin: 24px auto;" />

<pre><code class="javascript">var myChart = Highcharts.chart(container, &#123;
  yAxis: &#123;
    title: &#123; text: &quot;攝氏溫度&quot; &#125;,
    labels: &#123; format: &quot;&#123;value&#125;°C&quot;&#125;
  &#125;,
  tooltip: &#123;
    headerFormat: &quot;&#123;point.key:%Y/%m/%d %A&#125;&lt;br/&gt;&quot;,
    pointFormatter() &#123;
      let type =  this.custom ? &quot;最高溫度&quot; : &quot;平均溫度&quot;;
      let time = this.custom ? `($&#123;this.custom&#125;)` : &quot;&quot; ;
      return `$&#123;type&#125;: $&#123;this.y&#125;°C $&#123;time&#125;`
    &#125;
  &#125;,
&#125;);</code></pre>
<p>最後把上面的符號表規則應用在昨天學到的格式化屬性後，我們就有一個非常完美的客製化圖表了，同時也把「日期座標軸」的設定方法和應用搞清楚了。</p>
<img src="format.png" style="max-width: 650px; margin: 24px auto;" />

<p><br/><br/></p>
<p>今天利用了一整個範例來學習「日期座標軸」，並且成功製作了一個包含時間維度的圖表，相信未來如果有類似需求，各位應該可以易如反掌得解決了。而明天要繼續跟大家介紹的是「主題設定」。</p>
<hr>
<p>- 此篇文章為「iT邦幫忙鐵人賽」參賽文章，同步發表於 <a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10246182">iT邦幫忙</a> -</p>

        </div>
      
    
  </div>

  <footer class="article-footer">
    <!-- 
      <a href="https://maxleebk.com/2020/09/29/highchart/highcharts-15/#disqus_thread" class="article-comment-link">Comments</a>
     -->
    <div>
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/12th%E9%90%B5%E4%BA%BA%E8%B3%BD/" rel="tag">12th鐵人賽</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Highcharts/" rel="tag">Highcharts</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li></ul>

    </div>
    <a data-url="https://maxleebk.com/2020/09/29/highchart/highcharts-15/" data-id="clo2despd000pobopbpbqgdf8" class="article-share-link">分享</a>
  </footer>
  
    
<nav id="article-nav">
  
    <div id="article-nav-older" class="article-nav-link-wrap">
      
      <strong class="article-nav-caption">前一篇文章</strong></br>
      <a href="/2020/09/28/highchart/highcharts-14/" class="article-nav-title">資視就是力量 - Highcharts / 格式化屬性</a>
      
    </div>
  
  
    <div id="article-nav-newer" class="article-nav-link-wrap">
      
      <strong class="article-nav-caption">下一篇文章</strong></br>
      <a href="/2020/09/30/highchart/highcharts-16/" class="article-nav-title">
        
          資視就是力量 - Highcharts / 主題設定
        
      </a>
      
    </div>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2023 Max Lee ｜ Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Article</a>
  
</nav>
    
<script>
  var disqus_shortname = 'f820602h';
  
  var disqus_url = 'https://maxleebk.com/2020/09/29/highchart/highcharts-15/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<!-- Highlight.js -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@latest/build/styles/vs2015.min.css">
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@latest/build/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>